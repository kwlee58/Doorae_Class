{
    "contents" : "---\ntitle: \"관광두레 주민공동체 현황분석\"\nauthor: \"한림대학교 이기원\"\noutput: html_document\n---\n\n## 자료 구조\n\n### 기초자료\n\n```{r, echo=FALSE, message=FALSE}\nload(\"./doorae_new1015.rda\")\nload(\"./coord.rda\")\nlibrary(knitr)\nlibrary(extrafont)\nloadfonts()\noptions(family=\"HCR Dotum\")\n```\n\n\n```{r, echo=FALSE}\ndoorae <- doorae0924\ndoorae.ys <- doorae0924.ys\n(str.doorae.1 <- str(doorae[, 1:24]))\n```\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n\n### 성과자료\n\n```{r, echo=FALSE}\n(str.doorae.2 <- str(doorae[, 25:54]))\n```\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n\n## 변수별 기초통계 및 요약\n\n```{r echo=FALSE}\noptions(width=132)\noptions(digits=3)\ncols.no.summary.names <-c(\"설립일\", \"사업자등록\", \"업태\", \"종목\", \"소재지\", \"사업명\", \"아이디어\", \"대표상품\") \ncols.no.summary <- which(names(doorae) %in% cols.no.summary.names)\n(doorae.summary<-sapply(doorae[,-cols.no.summary], summary))\n```\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n\n# 교차분석\n\n## 공동체상태와 조직형태\n\n### 교차표\n\n\n```{r, echo=FALSE, message=FALSE}\nstatus.vs.structure<-table(doorae$\"공동체상태\", doorae$\"조직형태\", dnn=c(\"공동체상태\", \"조직형태\"))\nstatus.vs.structure.am <- addmargins(status.vs.structure)\ndimnames(status.vs.structure.am)[[1]][3] <- \"계\"\ndimnames(status.vs.structure.am)[[2]][3] <- \"계\"\nstatus.vs.structure.ap <- prop.table(status.vs.structure, margin=1)*100\nstatus.vs.structure.ap <-addmargins(status.vs.structure.ap)[1:2,]\ndimnames(status.vs.structure.ap)[[2]][3] <- \"계\"\nstatus.vs.structure.ap.2 <-addmargins(prop.table(status.vs.structure, margin=2)*100)[,1:2]\ndimnames(status.vs.structure.ap.2)[[1]][3] <- \"계\"\n```\n\n```{r, echo=FALSE, results='asis'}\nkable(status.vs.structure, caption = \"ㅇ공동체상태와 조직형태\")\nkable(status.vs.structure.ap, digits=3, caption=\"ㅇ공동체상태와 조직형태(%, 계)\")\nkable(status.vs.structure.ap.2, digits=3, caption=\"ㅇ조직형태와 공동체상태(%, 계)\")\n```\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n\n### 모자이크 플롯\n\n* 공동체상태와 조직형태\n    * 경영개선 상태에서 법인격을 갖춘 공동체사업의 비율이 창업준비 상태에서 법인격을 갖춘 공동체사업의 비율보다 압도적으로 많다는 점에 유의.\n\n```{r, echo=FALSE, fig.width=4, fig.height=4}\nmosaicplot(status.vs.structure, color=TRUE, main=\"공동체상태와 조직형태\")\ntext(coord.text, labels=t(status.vs.structure), col=c(\"white\", \"black\"))\n```\n\n* 조직형태와 공동체상태\n    * 이는 거꾸로 법인격을 갖춘 공동체사업체 중에 경영개선 상태에 들어간 비율이 압도적으로 많다는 것으로 이해할 수도 있음.\n\n```{r, echo=FALSE, fig.width=4, fig.height=4}\nmosaicplot(t(status.vs.structure), color=TRUE, main=\"조직형태와 공동체상태\")\ntext(coord.text.1.2, labels=status.vs.structure, col=c(\"white\", \"black\"))\n```\n\n\n## 성장단계 구분에의 시사점\n\n```{r, echo=FALSE}\ndoorae$regi.kr <- factor(doorae$\"사업자등록여부\", levels=c(\"Yes\", \"No\"), labels=c(\"등록\", \"미등록\"))\ndoorae$busi.kr <- factor(doorae$\"성과_사업착수\", levels=c(\"Yes\", \"No\"), labels=c(\"착수\", \"미착수\"))\ncorporate.bi <- which(doorae$\"공동체상태\" == \"경영개선\" & doorae$\"조직형태\" == \"법인\")\nnoncorporate.bi <- which(doorae$\"공동체상태\" == \"경영개선\" & doorae$\"조직형태\" == \"임의단체\")\ncorporate.bp <- which(doorae$\"공동체상태\" == \"창업준비\" & doorae$\"조직형태\" == \"법인\")\nnoncorporate.bp <- which(doorae$\"공동체상태\" == \"창업준비\" & doorae$\"조직형태\" == \"임의단체\")\nv.names <- c(\"공동체상태\", \"조직명\", \"busi.kr\", \"regi.kr\", \"성과_매출_2014\", \"성과_매출_2015_3개월\")\nc.names <- c(\"공동체상태\", \"조직명\", \"사업착수여부\", \"사업자등록여부\", \"2014년매출\", \"2015년(3개월)매출\")\n```\n\n\n* 경영개선 상태의 법인 조직\n    * 모두 사업에 착수하였고, 사업자등록도 마침. 매출도 대부분 발생\n\n```{r, results='asis', echo=FALSE}\nkable(doorae[corporate.bi, v.names], row.names= FALSE, col.names=c.names)\n```\n\n-----\n\n-----\n\n-----\n\n\n* 경영개선 상태의 임의단체 조직 \n    * 임의단체인 경우가 소수 있으나 모두 사업에 착수하였고, 사업자등록도 마침. 모두 매출 발생\n    \n```{r, results='asis', echo=FALSE}\nkable(doorae[noncorporate.bi, v.names], row.names= FALSE, col.names=c.names)\n```\n\n* 창업준비 상태의 법인 조직\n    * 사업미착수는 39%, 사업자미등록이 32%에 달함. 매출 극히 일부 발생.\n    \n```{r, results='asis', echo=FALSE}\nkable(doorae[corporate.bp, v.names], row.names= FALSE, col.names=c.names)\n```\n\n* 창업준비 상태의 임의단체 조직 \n    * 대부분 사업미착수(83%)이고, 사업자미등록(93%)인 상태임. 매출 극히 일부에서 발생하는 것으로 보고하고 있으나 개인사업자 명의의 실적임. \n\n```{r, results='asis', echo=FALSE}\nkable(doorae[noncorporate.bp, v.names], row.names= FALSE, col.names=c.names)\n```\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n\n### 3원 교차분석\n\n```{r, echo=FALSE}\ncomm_stat.org_str.reg.ftbl <- ftable(table(\"공동체상태 :\"=doorae$\"공동체상태\", \"조직형태 :\"=doorae$\"조직형태\", \"사업자등록여부:\"=doorae$regi.kr))\ncomm_stat.org_str.busi.ftbl <- ftable(table(\"공동체상태 :\"=doorae$\"공동체상태\", \"조직형태 :\"=doorae$\"조직형태\", \"사업착수여부 :\"=doorae$busi.kr))\nk1 <- kable(as.matrix(comm_stat.org_str.reg.ftbl), caption = \"* 공동체상태/조직형태와 사업자등록여부\")\nk2 <- kable(round(as.matrix(prop.table(comm_stat.org_str.reg.ftbl, margin=1)*100), digits=1),  caption = \"* 공동체상태/조직형태와 사업자등록여부(%)\" )\nk3 <- kable(as.matrix(comm_stat.org_str.busi.ftbl), caption = \"* 공동체상태/조직형태와 사업착수여부\")\nk4 <- kable(round(as.matrix(prop.table(comm_stat.org_str.busi.ftbl, margin=1)*100), digits=1),  caption = \"* 공동체상태/조직형태와 사업착수여부(%)\")\n```\n\n\n```{r, echo=FALSE}\nk1\n```\n\n----------\n\n\n```{r, echo=FALSE}\nk2\n```\n\n\n----------\n\n\n```{r, echo=FALSE}\nk3\n```\n\n----------\n\n\n```{r, echo=FALSE}\nk4\n```\n\n\n-----\n\n-----\n\n\n## 공동체상태와 법인유형\n\n### 교차표\n\n```{r, results='asis', echo=FALSE}\nstatus.vs.corporate_type<-table(doorae$\"공동체상태\", doorae$\"법인유형\", dnn=c(\"공동체상태\", \"조직유형\"))\nkable(status.vs.corporate_type, caption=\"<공동체상태와 조직유형>\")\n````\n\n```{r, results='asis', echo=FALSE}\nstock.co<-which(doorae$\"법인유형\"==\"주식회사\")\nkable(doorae[stock.co, c(\"공동체상태\", \"조직명\")], caption=\"<주식회사인 공동체사업체>\")\n```\n\n### 모자이크 플롯\n\n```{r, echo=FALSE, fig.width=4.8, fig.height=4.8}\nmosaicplot(status.vs.corporate_type, color=TRUE, main=\"공동체상태와 조직유형\", las=1)\ntext(coord.text.2, labels=t(status.vs.corporate_type), cex=0.8, col=c(rep(\"white\", 2), rep(\"black\", 5)))\n```\n\n\n## 공동체상태와 사업아이템\n\n### 교차표(개소수)\n\n* 경영개선 상태에서는 '식음'과 '체험', 창업준비 상태에서는 '식음'과 '관광기념품'이 많이 있음.\n\n```{r, results='asis', echo=FALSE}\nstatus.vs.business_item <- table(doorae$\"공동체상태\", doorae$\"사업아이템\", dnn=c(\"공동체상태\", \"사업아이템\"))\nstatus.vs.business_item.am <- addmargins(status.vs.business_item, margin=2)\ndimnames(status.vs.business_item.am)[[2]][8] <- \"계\"\nkable(status.vs.business_item.am, caption= \"<공동체상태와 사업아이템>\")\n```\n\n### 교차표(%) \n\n* 창업준비 상태에서 '관광기념품'의 비중이 매우 높음.\n\n```{r, results='asis', echo=FALSE}\nstatus.vs.business_item.p <- prop.table(status.vs.business_item, margin=1)*100\nstatus.vs.business_item.p.am <- addmargins(status.vs.business_item.p, margin=2)\ndimnames(status.vs.business_item.p.am)[[2]][8] <- \"계\"\nkable(round(status.vs.business_item.p.am, digits=1), caption= \"<공동체상태와 사업아이템(%)>\")\n```\n\n### 모자이크 플롯\n\n```{r, echo=FALSE, fig.width=4.8, fig.height=4.8}\nmosaicplot(status.vs.business_item, color=TRUE, main=\"공동체상태와 사업아이템\", las=1)\ntext(coord.text.3, labels=t(status.vs.business_item), cex=0.8, col=c(rep(\"white\", 2), rep(\"black\", 5)))\n```\n\n\n## 공동체상태와 업력\n\n* 경영개선 상태에서 업력이 중위수비교나 평균적으로 3년 이상 오래됨.\n    * 경영개선 상태에 진입하기까지의 기간에 대한 시사점.\n    * 창업준비 상태에서 예그리나(11.6년)와 같이 예외적인 경우도 있음.\n\n### 요약표\n\n```{r, echo=FALSE}\ntapply(doorae$\"업력\", doorae$\"공동체상태\", summary)\n```\n\n### Box Plot\n\n* 공동체 상태별 5숫자 요약 및 이상점 파악 \n    * '아름다운인제관광'과 '예그리나'가 예외적으로 오랜 업력\n\n```{r, echo=FALSE, fig.width=5, fig.height=5}\nlibrary(ggplot2)\nlibrary(grid)\nsource(\"theme_kr_Dotum.R\")\nbox.1 <- ggplot(doorae.ys, aes(x=status, y=years)) + geom_boxplot() \nbox.2 <- box.1 + theme_bw() + theme.kr.Dotum\nbox.3 <- box.2 + ggtitle(\"공동체상태와 업력\") + xlab(\"공동체상태\") + ylab(\"업력(년)\") \nbox.4 <- box.3 + scale_x_discrete(labels=c(\"창업준비\", \"경영개선\")) \nbox.5 <- box.4 + annotate(\"text\", x=c(1, 2), y=c(12.2, 13), label=c(\"예그리나\", \"아름다운인제관광\"), size=3.5, family=\"HCR Dotum\")\nbox.5\n```\n\n-----\n\n-----\n\n### ECDF\n\n* 분위수 비교 뿐 아니라 평균 업력 비교도 가능함\n\n```{r echo=FALSE, fig.width=4.5, fig.height=4.5}\necdf.1 <- ggplot(doorae.ys, aes(x=years, colour=status)) \necdf.2 <- ecdf.1 + stat_ecdf()\necdf.3 <- ecdf.2 + theme_bw() + theme.kr.Dotum\necdf.4 <- ecdf.3 + ggtitle(\"공동체상태와 업력\") + xlab(\"업력(년)\") + ylab(\"분위\") \necdf.5 <- ecdf.4 + labs(colour=\"공동체상태\")\necdf.6 <- ecdf.5 + scale_colour_grey(labels=c(\"창업준비\", \"경영개선\")) + theme(legend.text=element_text(family=\"HCR Dotum\"))\necdf.7 <- ecdf.6 + theme(legend.position=c(0.8, 0.5))\necdf.8 <- ecdf.7 + annotate(\"segment\", x=1.37, xend=4.46, y=0.5, yend=0.5, colour=\"gray50\", arrow=arrow(ends=\"both\", length=unit(0.2, \"cm\")))\necdf.9 <- ecdf.8 + scale_x_continuous(breaks=c(0, 1.3, 4.39, 12.3), labels=c(0, 1.3, 4.39, 12.3))\necdf.10 <- ecdf.9 + annotate(\"text\", x=2.8, y=0.54, label=\"중위수의 차이\", size=3, family=\"HCR Dotum\")\necdf.11 <- ecdf.10 + annotate(\"text\", x=2.8, y=0.46, label=\"약 3년\", size=3, family=\"HCR Dotum\")\necdf.11\n```\n\n```{r, echo=FALSE}\nx.pre <- tapply(doorae.ys$years, doorae.ys$status, sort)$\"창업준비\"\nx.post <- tapply(doorae.ys$years, doorae.ys$status, sort)$\"경영개선\"\nn.pre<-length(x.pre)\nn.post <- length(x.post)\ny.pre <- (1:n.pre)/n.pre\ny.post <- (1:n.post)/n.post\necdf.x.pre <- c(0, rep(x.pre, each=2))\necdf.y.pre <- c(rep(c(0, head(y.pre, -1)), each=2), 1)\necdf.x.post <- c(0, rep(x.post, each=2))\necdf.y.post <- c(rep(c(0, head(y.post, -1)), each=2), 1)\nyears.x <- c(ecdf.x.pre, rev(ecdf.x.post))\nyears.y <- c(ecdf.y.pre, rev(ecdf.y.post))\nyears.df <- data.frame(years = years.x, ecdf.years = years.y)\n```\n\n\n```{r echo=FALSE, fig.width=4.5, fig.height=4.5}\npoly.1 <- ggplot(years.df, aes(x = years, y = ecdf.years)) + geom_path()\npoly.2 <- poly.1 + geom_polygon(alpha = 0.3, fill = \"gray\") \npoly.3 <- poly.2 + theme_bw() + theme.kr.Dotum\npoly.4 <- poly.3 + ggtitle(\"공동체상태와 업력\") + xlab(\"업력(년)\") + ylab(\"분위\")\npoly.5 <- poly.4 + theme(legend.position=c(0.8, 0.5))\npoly.6 <- poly.5 + scale_x_continuous(breaks=c(0, 1.3, 4.39, 12.3), labels=c(0, 1.3, 4.39, 12.3))\npoly.7 <- poly.6 + annotate(\"text\", x=4.4, y=0.78, label=\"두 도표 간 면적은\\n평균의 차이,\\n약 3년\", size=4, angle=15, family=\"HCR Dotum\")\npoly.8 <- poly.7 + annotate(\"text\", x=6, y=0.6, label=\"경영개선\", size=4, family=\"HCR Dotum\")\npoly.9 <- poly.8 + annotate(\"text\", x=1, y=0.9, label=\"창업준비\", size=4, family=\"HCR Dotum\")\npoly.9\n```\n\n### Dot Chart\n\n* 전체 주민공동체사업의 업력을 공동체상태별로 한눈에 비교 \n    * 개별 조직명도 파악됨.\n\n```{r echo=FALSE, fig.width=6, fig.height=9}\nnameorder <- doorae$\"조직명\"[order(doorae$\"공동체상태\", doorae$\"업력\")]\ndoorae$name <- factor(doorae$\"조직명\", levels = nameorder)\nd.1 <- ggplot(doorae, aes(x=업력, y=name)) + geom_segment(aes(yend=name), xend=0, colour=\"grey50\")\nd.2 <- d.1 + geom_point(size=3, aes(colour=공동체상태)) \nd.3 <- d.2 + scale_colour_grey(limits=c(\"경영개선\", \"창업준비\"))\nd.4 <- d.3 + theme_bw() + theme.kr.Dotum\nd.6 <- d.4 + ylab(\"조직명\") + ggtitle(\"공동체상태별 업력\") \nd.7 <- d.6 + theme(axis.text.y=element_text(family=\"HCR Dotum\", size=6)) \nd.8 <- d.7 + theme(panel.grid.major.y=element_blank(), \n                   legend.position=c(1, 0.55), \n                   legend.justification=c(1, 0.5))\nd.8 \n```\n\n\n## 방문객과 매출 요약\n\n### 공동체상태별 평균 비교\n\n```{r, echo=FALSE}\nstatus.visitors.sales.mean <- aggregate(doorae[c(\"성과_방문객_2014\", \"성과_방문객_2015_3개월\", \"성과_매출_2014\", \"성과_매출_2015_3개월\")], list(\"공동체상태\"=doorae$\"공동체상태\"), mean)\nv.vs.names <- c(\"공동체상태\", \"방문객(2014)\", \"방문객(2015, 3개월)\", \"매출(2014)\", \"매출(2015, 3개월)\")\nkable(status.visitors.sales.mean, col.names = v.vs.names)\n```\n\n### 공동체상태별 중위수 비교\n\n```{r, echo=FALSE}\nstatus.visitors.sales.median <- aggregate(doorae[c(\"성과_방문객_2014\", \"성과_방문객_2015_3개월\", \"성과_매출_2014\", \"성과_매출_2015_3개월\")], list(\"공동체상태\"=doorae$\"공동체상태\"), median)\nkable(status.visitors.sales.median, col.names = v.vs.names)\n```\n\n\n## 방문객 및 매출 상위 조직\n\n```{r, echo=FALSE}\no.visitors.14 <- order(doorae$\"성과_방문객_2014\", decreasing=TRUE)\nv.names.v.14 <- c(\"공동체상태\", \"조직명\", \"성과_방문객_2014\")\nc.names.v.14 <- c(\"공동체상태\", \"조직명\", \"방문객(2014)\")\no.visitors.15 <- order(doorae$\"성과_방문객_2015_3개월\", decreasing=TRUE)\nv.names.v.15 <- c(\"공동체상태\", \"조직명\", \"성과_방문객_2015_3개월\")\nc.names.v.15 <- c(\"공동체상태\", \"조직명\", \"방문객(2015, 3개월)\")\no.sales.14 <- order(doorae$\"성과_매출_2014\", decreasing=TRUE)\nv.names.s.14 <- c(\"공동체상태\", \"조직명\", \"성과_매출_2014\")\nc.names.s.14 <- c(\"공동체상태\", \"조직명\", \"매출(2014)\")\no.sales.15 <- order(doorae$\"성과_매출_2015_3개월\", decreasing=TRUE)\nv.names.s.15 <- c(\"공동체상태\", \"조직명\", \"성과_매출_2015_3개월\")\nc.names.s.15 <- c(\"공동체상태\", \"조직명\", \"매출(2015, 3개월)\")\n```\n\n### 방문객(2014)\n\n```{r, results='asis', echo=FALSE}\nkable(doorae[o.visitors.14, v.names.v.14][1:20, ], row.names=FALSE, col.names=c.names.v.14)\n```\n\n### 방문객(2015, 3개월)\n\n```{r, results='asis', echo=FALSE}\nkable(doorae[o.visitors.15, v.names.v.15][1:20, ], row.names=FALSE, col.names=c.names.v.15)\n```\n\n### 매출(2014)\n\n```{r, results='asis', echo=FALSE}\nkable(doorae[o.sales.14, v.names.s.14][1:20, ], row.names=FALSE, col.names=c.names.s.14)\n```\n\n### 매출(2015, 3개월)\n\n```{r, results='asis', echo=FALSE}\nkable(doorae[o.sales.15, v.names.s.15][1:20, ], row.names=FALSE, col.names=c.names.s.15, align=c('l', 'l', 'r'))\n```\n\n\n### 자료 갈무리\n\n```{r}\ndoorae0928 <- doorae\nsave.image(\"doorae_new_lab.rda\")",
    "created" : 1444905154849.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1113593229",
    "id" : "14E61E13",
    "lastKnownWriteTime" : 1444927191,
    "path" : "V:/Works/Research_Data/Doorae/R/Doorae_bw_lab_short.Rmd",
    "project_path" : "R/Doorae_bw_lab_short.Rmd",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_markdown"
}